inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=data.frame(), aes(x=Industry, y=Employees, label=1:3), col='red', size=10)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(x=Industry, y=Employees, label=1:3), col='red', size=10)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(x=Industry, y=Employees), col='red', size=10)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=Employees))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1900))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1500))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1200))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=inc, aes(label=summarise(mean(Employees))))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = mean(Employees))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp, aes(label=median_emp))
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))
#+
#                geom_text(data=df_median_emp, aes(label=median_emp))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+                geom_text(data=df_median_emp, aes(label=median_emp))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(aes(x= Industry, y = median(Employees) , label =median(Employees)), position=position_dodge(width = 0.8),size = 3, vjust = -0.5,colour="blue")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position=position_dodge(width = 0.8),
size = 3, vjust = 0,colour="blue")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position=position_dodge(width = 0.8),
size = 3, vjust = 0,colour="blue")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position = position_dodge(width = 0.8),
size = 3, vjust = -0.5)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position = position_dodge(width = 0.8),
size = 3, vjust = -1)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position = position_dodge(width = 0.8),
size = 3, hjust = -1)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position = position_dodge(width = 0.8),
size = 3, vjust = 2)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))+
geom_text(data=df_median_emp,aes(x= Industry,
y = median_emp,
label =median_emp),
position = position_dodge(width = 0.8),
size = 3, vjust = 0,hjust=0)
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
# additional libraries added
library(ggplot2)
library(dplyr)
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
head(inc)
summary(inc)
# Insert your code here, create more chunks as necessary
glimpse(inc)
# Note: not needed but verified that a company's name did not appear more than once by state
(inc%>%
count(State,Name)%>%
filter(n>1))
# Answer Question 1 here
inc %>%
group_by(State) %>%
summarise(count = n())%>%
ggplot(aes(x=reorder(State,-count),y=count))+
geom_bar(stat="identity",width =.9)+coord_flip()+
geom_text(aes(label = count),
vjust = .5, hjust = -.5,
size = 3, color="black")+
xlab("States")+
ylab("# of Companies")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
# Answer Question 2 here
df_median_emp<-inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(median_emp = round(mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
select(Industry,Employees)%>%
ggplot(aes(x=Industry,y=Employees))+
geom_boxplot()+
coord_cartesian(ylim = c(0,1000))+
theme(axis.text.x=element_text(angle=55,hjust=1))
# Could not resolve alignment for labels.
#              +
#                geom_text(data=df_median_emp,aes(x= Industry,
#                              y = median_emp,
#                              label =median_emp),
#                         position = position_dodge(width = 0.8),
#                          size = 3, vjust = 0,hjust=0)
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=Industry,y=rev_per_emp))+
geom_bar()
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=Industry,y=rev_per_emp))+
geom_bar(stat="Identity")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=Industry,y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()
#inc[complete.cases(inc),]%>%
#    filter(State=="NY")%>%
#      group_by(Industry) %>%
#	      summarise(median_emp = round(mean(Employees)))
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = rev_per_emp),
vjust = .5, hjust = -.5,
size = 3, color="black")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = -.5,
size = 3, color="black")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = .5,
size = 3, color="black")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = 1,
size = 3, color="black")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = 1,
size = 3, color="white")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = 1.5,
size = 3, color="white")+
xlab("Industry")+
ylab("Revenue Per Employee")
inc[complete.cases(inc),]%>%
filter(State=="NY")%>%
group_by(Industry) %>%
summarise(total_rev=sum(Revenue),
total_emp=sum(Employees),
rev_per_emp=total_rev/total_emp)%>%
ggplot(aes(x=reorder(Industry,-rev_per_emp),y=rev_per_emp))+
geom_bar(stat="Identity")+
coord_flip()+
geom_text(aes(label = round(rev_per_emp)),
vjust = .5, hjust = 1.2,
size = 3, color="white")+
xlab("Industry")+
ylab("Revenue Per Employee")
setwd("~/DATA608/CUNY_DATA_608/module3")
# Module 3
I have provided you with data about mortality from all 50 states and the District of Columbia.
I have provided you with data about mortality from all 50 states and the District of Columbia.
```{r, message=FALSE}
I have provided you with data about mortality from all 50 states and the District of Columbia.
[https://github.com/charleyferrari/CUNY_DATA608/tree/master/module3/data](https://github.com/GitableGabe/CUNY_DATA_608/tree/master/module3/data) You are
## Question 2:
Often you are asked whether particular States are improving their mortality rates (per cause) faster than, or slower than, the national average. Create a visualization that lets your clients see this for themselves for one cause of death at the time. Keep in mind that the national average should be weighted by the national population.
install.packages("shiny")
# additional libraries added
library(ggplot2)
library(dplyr)
library(shiny)
runApp("Sample Apps/ggplot-reactive.R")
pwd
knitr::include_graphics(c("fluidpage.png","fluidpage.png"))
# Libraries
library(ggplot2)
library(dplyr)
library(shiny)
cdc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
ui <- fluidPage(
titlePanel("Crude Mortality Rate Across All States by Causes"),
sidebarLayout(
selectInput("select", label = h3("Causes of Death"),
choices = cdc$ICD.Chapter,
selected = 1,
width = '100%'),
mainPanel(
plotOutput("distPlot")
)
)
)
server <- function(input, output) {
output$distPlot <- renderPlot({
ggplot(cdc[cdc$ICD.Chapter == input$select,] , aes(x = reorder(State, Crude.Rate), y = Crude.Rate)) +
labs(x = "State", y = "Crude Mortality Rate") +
geom_bar(stat = "identity") +
coord_flip() +
theme_minimal()
}, width = 'auto', height = 'auto')
}
shinyApp(ui = ui, server = server)
View(cdc)
cdc <- read.csv("cleaned-cdc-mortality-1999-2010-2", header= TRUE)
cdc <- read.csv("data/cleaned-cdc-mortality-1999-2010-2", header= TRUE)
cdc <- read.csv("data\cleaned-cdc-mortality-1999-2010-2", header= TRUE)
cdc <- read.csv("data/cleaned-cdc-morality-1999-2010-2.csv", header= TRUE)
setwd("~/DATA608/CUNY_DATA_608/module3")
cdc <- read.csv("data/cleaned-cdc-morality-1999-2010-2.csv", header= TRUE)
pwd
cd
ls
dir
cdc <- read.csv("~/DATA608/CUNY_DATA_608/module3/datacleaned-cdc-morality-1999-2010-2.csv", header= TRUE)
cdc <- read.csv("~/DATA608/CUNY_DATA_608/module3/data/cleaned-cdc-morality-1999-2010-2.csv", header= TRUE)
cdc <- read.csv("~/DATA608/CUNY_DATA_608/module3/data/cleaned-cdc-mortality-1999-2010-2.csv", header= TRUE)
cdc <- read.csv("data/cleaned-cdc-mortality-1999-2010-2.csv", header= TRUE)
